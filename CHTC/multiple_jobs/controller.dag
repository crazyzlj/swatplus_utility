# controller.dag
# This is the main workflow DAG.

# --- 1. Prepare inputs and worker_jobs.dag for multiple jobs ---
JOB PREPARE_JOBS controller_job.sub

# --- 2. Submit all worker jobs ---
# This is a sub-DAG, generated by PREPARE_JOBS
SUBDAG EXTERNAL RUN_WORKERS worker_jobs.dag

# --- Dependence relations ---
PARENT PREPARE_JOBS CHILD RUN_WORKERS